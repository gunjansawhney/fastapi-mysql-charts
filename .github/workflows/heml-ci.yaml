name: Helm Chart CI

on:
  push:
    paths:
      - 'fastapi-chart/**'
      - '.github/workflows/helm-ci.yaml'

jobs:
  lint-and-package:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Helm
      uses: azure/setup-helm@v3
      with:
        version: v3.13.0

    - name: Lint Helm Chart
      run: helm lint fastapi-chart

    - name: Package Helm Chart
      run: helm package fastapi-chart

    - name: Upload Helm Chart Artifact
      uses: actions/upload-artifact@v3
      with:
        name: fastapi-chart
        path: ./fastapi-chart-*.tgz

